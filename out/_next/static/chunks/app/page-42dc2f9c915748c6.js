(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3850:function(e,t,s){Promise.resolve().then(s.bind(s,7340))},7340:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var l=s(7437),r=s(2265),a=s(2141),n=s(9476),i=s(8736),c=s(8420),d=s(1671),o=s(525),x=s(6865),p=s(5252),u=s(5805),m=s(1723);function h(){let[e,t]=(0,r.useState)({totalProjects:0,totalPOs:0,totalMilestones:0,completedMilestones:0,overdueMilestones:0,totalBudget:0,activeVendors:0,completionRate:0}),[s,h]=(0,r.useState)([]),[g,y]=(0,r.useState)(!0),[j,f]=(0,r.useState)(!1);(0,r.useEffect)(()=>{v()},[]);let v=async()=>{try{let{data:e,error:s}=await a.O.from("project_overview").select("*");if(s)throw s;let l=(null==e?void 0:e.length)||0,r=(null==e?void 0:e.reduce((e,t)=>e+(t.total_purchase_orders||0),0))||0,n=(null==e?void 0:e.reduce((e,t)=>e+(t.total_milestones||0),0))||0,i=(null==e?void 0:e.reduce((e,t)=>e+(t.completed_percentage||0),0))||0,c=(null==e?void 0:e.reduce((e,t)=>e+(t.overdue_milestones||0),0))||0,d=(null==e?void 0:e.reduce((e,t)=>e+(t.budget||0),0))||0,{data:o,error:x}=await a.O.from("vendor_performance").select("vendor_id").gt("total_milestones",0);if(x)throw x;t({totalProjects:l,totalPOs:r,totalMilestones:n,completedMilestones:i,overdueMilestones:c,totalBudget:d,activeVendors:(null==o?void 0:o.length)||0,completionRate:n>0?i/n*100:0}),h(e||[])}catch(e){console.error("Error fetching dashboard data:",e)}finally{y(!1)}},b=e=>{let{title:t,value:s,icon:r,color:a="blue",subtitle:n}=e;return(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 card-hover",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:t}),(0,l.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:s}),n&&(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:n})]}),(0,l.jsx)("div",{className:"p-3 rounded-full ".concat({blue:"bg-blue-500",green:"bg-green-500",yellow:"bg-yellow-500",red:"bg-red-500",purple:"bg-purple-500"}[a]),children:(0,l.jsx)(r,{className:"h-6 w-6 text-white"})})]})})};return g?(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Milestone Tracker"}),(0,l.jsx)("p",{className:"text-gray-600 mt-1",children:"Procurement & Construction Management"})]}),(0,l.jsx)("div",{className:"flex items-center space-x-4",children:(0,l.jsxs)("button",{onClick:()=>f(!0),className:"btn-primary",children:[(0,l.jsx)(i.Z,{className:"h-4 w-4 mr-2"}),"New Project"]})})]})})}),(0,l.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,l.jsx)(b,{title:"Total Projects",value:e.totalProjects,icon:c.Z,color:"blue"}),(0,l.jsx)(b,{title:"Purchase Orders",value:e.totalPOs,icon:i.Z,color:"purple"}),(0,l.jsx)(b,{title:"Total Milestones",value:e.totalMilestones,icon:d.Z,color:"green"}),(0,l.jsx)(b,{title:"Completion Rate",value:"".concat(e.completionRate.toFixed(1),"%"),icon:o.Z,color:"green",subtitle:"".concat(e.completedMilestones," completed")})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,l.jsx)(b,{title:"Overdue Milestones",value:e.overdueMilestones,icon:x.Z,color:"red"}),(0,l.jsx)(b,{title:"Total Budget",value:"$".concat((e.totalBudget/1e6).toFixed(1),"M"),icon:p.Z,color:"blue"}),(0,l.jsx)(b,{title:"Active Vendors",value:e.activeVendors,icon:u.Z,color:"purple"}),(0,l.jsx)(b,{title:"In Progress",value:e.totalMilestones-e.completedMilestones,icon:m.Z,color:"yellow",subtitle:"milestones"})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,l.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,l.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Projects Overview"})}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Project"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Progress"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Milestones"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Overdue"})]})}),(0,l.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsx)("div",{className:"text-sm text-gray-900",children:e.client_name})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("planning"===e.status?"bg-yellow-100 text-yellow-800":"active"===e.status?"bg-green-100 text-green-800":"completed"===e.status?"bg-blue-100 text-blue-800":"on_hold"===e.status?"bg-orange-100 text-orange-800":"cancelled"===e.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:e.status.replace("_"," ").toUpperCase()})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:(0,l.jsx)("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(e.completed_percentage,"%")}})}),(0,l.jsxs)("span",{className:"text-sm text-gray-900",children:[e.completed_percentage.toFixed(1),"%"]})]})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.total_milestones}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.overdue_milestones>0?(0,l.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:e.overdue_milestones}):(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"0"})})]},e.id))})]})})]})]}),(0,l.jsx)(n.Z,{isOpen:j,onClose:()=>f(!1),onProjectCreated:()=>{v()}})]})}},8420:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});let l=(0,s(9205).Z)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},1671:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});let l=(0,s(9205).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1723:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});let l=(0,s(9205).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},8736:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});let l=(0,s(9205).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},525:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});let l=(0,s(9205).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},6865:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});let l=(0,s(9205).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])}},function(e){e.O(0,[56,182,971,117,744],function(){return e(e.s=3850)}),_N_E=e.O()}]);
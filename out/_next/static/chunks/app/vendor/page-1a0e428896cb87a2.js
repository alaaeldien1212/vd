(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[341],{4834:function(e,s,t){Promise.resolve().then(t.bind(t,9961))},9961:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return h}});var a=t(7437),r=t(2265),l=t(2141),d=t(1671),n=t(1723),i=t(6865),c=t(8736),x=t(8420),m=t(1047);let o=(0,t(9205).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function h(){let[e,s]=(0,r.useState)([]),[t,h]=(0,r.useState)([]),[p,u]=(0,r.useState)(!0),[g,y]=(0,r.useState)(null),[j,f]=(0,r.useState)(!1);(0,r.useEffect)(()=>{N()},[]);let N=async()=>{try{let{data:e,error:t}=await l.O.from("milestone_progress").select("*").not("po_number","is",null),{data:a,error:r}=await l.O.from("purchase_orders").select("\n          id,\n          po_number,\n          title,\n          total_amount,\n          currency,\n          status,\n          issue_date,\n          expected_delivery_date,\n          projects!inner(name)\n        ");if(t)throw t;if(r)throw r;s(e||[]),h((null==a?void 0:a.map(e=>{var s;return{...e,project_name:null===(s=e.projects)||void 0===s?void 0:s.name}}))||[])}catch(e){console.error("Error fetching vendor data:",e)}finally{u(!1)}},b=async(e,s)=>{try{let{error:t}=await l.O.from("milestones").update({completion_percentage:s,status:100===s?"completed":"in_progress"}).eq("id",e);if(t)throw t;N()}catch(e){console.error("Error updating milestone:",e)}},v=e=>{switch(e){case"completed":return(0,a.jsx)(d.Z,{className:"h-5 w-5 text-green-500"});case"approved":return(0,a.jsx)(d.Z,{className:"h-5 w-5 text-green-600"});case"in_progress":return(0,a.jsx)(n.Z,{className:"h-5 w-5 text-blue-500"});case"overdue":return(0,a.jsx)(i.Z,{className:"h-5 w-5 text-red-500"});default:return(0,a.jsx)(n.Z,{className:"h-5 w-5 text-gray-400"})}},w=e=>{switch(e){case"completed":return"bg-green-100 text-green-800";case"approved":return"bg-emerald-100 text-emerald-800";case"in_progress":return"bg-blue-100 text-blue-800";case"overdue":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return p?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"flex justify-between items-center py-6",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Vendor Portal"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage your milestones and purchase orders"})]})})})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 rounded-full bg-blue-500",children:(0,a.jsx)(c.Z,{className:"h-6 w-6 text-white"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Purchase Orders"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:t.length})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 rounded-full bg-green-500",children:(0,a.jsx)(d.Z,{className:"h-6 w-6 text-white"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Completed Milestones"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.filter(e=>"completed"===e.status).length})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 rounded-full bg-yellow-500",children:(0,a.jsx)(n.Z,{className:"h-6 w-6 text-white"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"In Progress"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.filter(e=>"in_progress"===e.status).length})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 rounded-full bg-red-500",children:(0,a.jsx)(i.Z,{className:"h-6 w-6 text-white"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Overdue"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.filter(e=>e.is_overdue).length})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-8",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Purchase Orders"})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"PO Number"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Project"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Due Date"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.po_number}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.project_name}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.title}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.currency," ",(e.total_amount/1e3).toFixed(0),"K"]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("issued"===e.status?"bg-blue-100 text-blue-800":"completed"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.status.replace("_"," ").toUpperCase()})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.expected_delivery_date&&new Date(e.expected_delivery_date).toLocaleDateString()})]},e.id))})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Milestones"})}),(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:e.map(e=>(0,a.jsx)("div",{className:"p-6 hover:bg-gray-50",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[v(e.status),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:e.name}),(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(w(e.status)),children:e.status.replace("_"," ").toUpperCase()}),e.is_overdue&&(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"OVERDUE"})]}),e.description&&(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-3",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center space-x-6 text-sm text-gray-500",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(x.Z,{className:"h-4 w-4 mr-1"}),(0,a.jsx)("span",{children:e.project_name})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4 mr-1"}),(0,a.jsx)("span",{children:e.po_number})]}),e.due_date&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(m.Z,{className:"h-4 w-4 mr-1"}),(0,a.jsxs)("span",{children:["Due: ",new Date(e.due_date).toLocaleDateString()]})]})]})]}),(0,a.jsxs)("div",{className:"ml-6 flex-shrink-0",children:[(0,a.jsxs)("div",{className:"text-right mb-4",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-500 mb-1",children:[e.completion_percentage,"% Complete"]}),(0,a.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(e.completion_percentage,"%")}})}),(0,a.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:["Weight: ",e.weight_percentage,"%"]})]}),"completed"!==e.status&&"approved"!==e.status&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("input",{type:"range",min:"0",max:"100",value:e.completion_percentage,onChange:s=>b(e.id,parseInt(s.target.value)),className:"w-full"}),(0,a.jsxs)("button",{onClick:()=>{y(e),f(!0)},className:"w-full btn-primary text-sm",children:[(0,a.jsx)(o,{className:"h-4 w-4 mr-2"}),"Upload Evidence"]})]})]})]})},e.id))})]})]}),j&&g&&(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,a.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Upload Evidence for ",g.name]}),(0,a.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[(0,a.jsx)(o,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Drag and drop files here, or click to select"}),(0,a.jsx)("input",{type:"file",multiple:!0,className:"mt-4 w-full",accept:".pdf,.jpg,.jpeg,.png,.doc,.docx"})]}),(0,a.jsxs)("div",{className:"mt-4 flex justify-end space-x-3",children:[(0,a.jsx)("button",{onClick:()=>f(!1),className:"btn-secondary",children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>{f(!1)},className:"btn-primary",children:"Upload"})]})]})})})]})}},2141:function(e,s,t){"use strict";t.d(s,{O:function(){return a}});let a=(0,t(8439).eI)("https://gbnmunfdgdnvlzcabyxf.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdibm11bmZkZ2Rudmx6Y2FieXhmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTczOTg5OTIsImV4cCI6MjA3Mjk3NDk5Mn0.dW5qalrprjBpW-A1SjKQ72dU-99JErIawkOuqHnVSBI")},8420:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9205).Z)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},1047:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9205).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},1671:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9205).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1723:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9205).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},8736:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9205).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},6865:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9205).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])}},function(e){e.O(0,[56,971,117,744],function(){return e(e.s=4834)}),_N_E=e.O()}]);
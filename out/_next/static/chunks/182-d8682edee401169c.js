"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[182],{9476:function(e,t,a){a.d(t,{Z:function(){return c}});var r=a(7437),n=a(2265),s=a(2141),i=a(2489),l=a(9397),o=a(5252);function c(e){let{isOpen:t,onClose:a,onProjectCreated:c}=e,[d,m]=(0,n.useState)({name:"",description:"",client_organization_id:"",project_manager_id:"",start_date:"",end_date:"",budget:"",currency:"USD"}),[u,g]=(0,n.useState)(!1),[p,x]=(0,n.useState)([]),[b,y]=(0,n.useState)([]),[h,f]=(0,n.useState)({}),[j,_]=(0,n.useState)(!1),[v,N]=(0,n.useState)({name:"",type:"client",contact_email:"",contact_phone:"",address:"",country:"",tax_id:""}),[w,k]=(0,n.useState)({});(0,n.useEffect)(()=>{t&&(C(),z())},[t]);let C=async()=>{try{let{data:e,error:t}=await s.O.from("organizations").select("id, name, type").eq("type","client").order("name");if(t)throw t;x(e||[])}catch(e){console.error("Error loading organizations:",e)}},z=async()=>{try{let{data:e,error:t}=await s.O.from("users").select("id, first_name, last_name, role").in("role",["admin","project_manager"]).order("first_name");if(t)throw t;y(e||[])}catch(e){console.error("Error loading users:",e)}},S=async()=>{let e={};if(v.name.trim()||(e.name="Organization name is required"),v.contact_email.trim()||(e.contact_email="Contact email is required"),v.contact_email&&!/\S+@\S+\.\S+/.test(v.contact_email)&&(e.contact_email="Please enter a valid email address"),k(e),!(Object.keys(e).length>0))try{let{data:e,error:t}=await s.O.from("organizations").insert({name:v.name.trim(),type:v.type,contact_email:v.contact_email.trim(),contact_phone:v.contact_phone.trim()||null,address:v.address.trim()||null,country:v.country.trim()||null,tax_id:v.tax_id.trim()||null}).select();if(t)throw t;let a=e[0];x(e=>[...e,a]),m(e=>({...e,client_organization_id:a.id})),N({name:"",type:"client",contact_email:"",contact_phone:"",address:"",country:"",tax_id:""}),k({}),_(!1),alert("Organization created successfully!")}catch(e){console.error("Error creating organization:",e),k({submit:"Failed to create organization. Please try again."})}},E=e=>{let{name:t,value:a}=e.target;m(e=>({...e,[t]:a})),h[t]&&f(e=>({...e,[t]:""}))},I=e=>{let{name:t,value:a}=e.target;console.log("Date input ".concat(t,":"),a),m(e=>({...e,[t]:a})),h[t]&&f(e=>({...e,[t]:""}))},D=()=>{let e={};return d.name.trim()||(e.name="Project name is required"),d.client_organization_id||(e.client_organization_id="Client organization is required"),d.project_manager_id||(e.project_manager_id="Project manager is required"),d.start_date&&d.end_date&&new Date(d.start_date)>=new Date(d.end_date)&&(e.end_date="End date must be after start date"),d.budget&&isNaN(Number(d.budget))&&(e.budget="Budget must be a valid number"),f(e),0===Object.keys(e).length},O=async e=>{if(e.preventDefault(),D()){g(!0);try{let{data:e,error:t}=await s.O.from("projects").insert({name:d.name.trim(),description:d.description.trim()||null,client_organization_id:d.client_organization_id,project_manager_id:d.project_manager_id,start_date:d.start_date||null,end_date:d.end_date||null,budget:d.budget?parseFloat(d.budget):null,currency:d.currency,status:"planning"}).select();if(t)throw t;let r=btoa("vendor_"+e[0].id+"_"+Date.now()),n=window.location.origin+"/vendor/"+r;console.log("Project created successfully:",e),console.log("Vendor URL:",n);try{await navigator.clipboard.writeText(n),alert("Project created successfully! Vendor URL copied to clipboard: ".concat(n))}catch(e){alert("Project created successfully! Vendor URL: ".concat(n))}m({name:"",description:"",client_organization_id:"",project_manager_id:"",start_date:"",end_date:"",budget:"",currency:"USD"}),f({}),c(),a()}catch(e){console.error("Error creating project:",e),f({submit:"Failed to create project. Please try again."})}finally{g(!1)}}};return t?(0,r.jsxs)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:[(0,r.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white",children:(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Create New Project"}),(0,r.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)(i.Z,{className:"h-6 w-6"})})]}),(0,r.jsxs)("form",{onSubmit:O,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Name *"}),(0,r.jsx)("input",{type:"text",id:"name",name:"name",value:d.name,onChange:E,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ".concat(h.name?"border-red-300":"border-gray-300"),placeholder:"Enter project name"}),h.name&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,r.jsx)("textarea",{id:"description",name:"description",value:d.description,onChange:E,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter project description"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"client_organization_id",className:"block text-sm font-medium text-gray-700 mb-2",children:"Client Organization *"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("select",{id:"client_organization_id",name:"client_organization_id",value:d.client_organization_id,onChange:E,className:"flex-1 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ".concat(h.client_organization_id?"border-red-300":"border-gray-300"),children:[(0,r.jsx)("option",{value:"",children:"Select client organization"}),p.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,r.jsx)("button",{type:"button",onClick:()=>_(!0),className:"px-3 py-2 bg-gray-100 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-200 flex items-center",title:"Create new organization",children:(0,r.jsx)(l.Z,{className:"h-4 w-4"})})]}),h.client_organization_id&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h.client_organization_id})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"project_manager_id",className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Manager *"}),(0,r.jsxs)("select",{id:"project_manager_id",name:"project_manager_id",value:d.project_manager_id,onChange:E,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ".concat(h.project_manager_id?"border-red-300":"border-gray-300"),children:[(0,r.jsx)("option",{value:"",children:"Select project manager"}),b.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.first_name," ",e.last_name," (",e.role,")"]},e.id))]}),h.project_manager_id&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h.project_manager_id})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"start_date",className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),(0,r.jsx)("input",{type:"date",id:"start_date",name:"start_date",value:d.start_date,onChange:I,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"end_date",className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),(0,r.jsx)("input",{type:"date",id:"end_date",name:"end_date",value:d.end_date,onChange:I,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ".concat(h.end_date?"border-red-300":"border-gray-300")}),h.end_date&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h.end_date})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"budget",className:"block text-sm font-medium text-gray-700 mb-2",children:"Budget"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"number",id:"budget",name:"budget",value:d.budget,onChange:E,className:"w-full px-3 py-2 pr-8 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ".concat(h.budget?"border-red-300":"border-gray-300"),placeholder:"0.00",step:"0.01",min:"0"}),(0,r.jsx)(o.Z,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]}),h.budget&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h.budget})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700 mb-2",children:"Currency"}),(0,r.jsxs)("select",{id:"currency",name:"currency",value:d.currency,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"USD",children:"USD"}),(0,r.jsx)("option",{value:"EUR",children:"EUR"}),(0,r.jsx)("option",{value:"GBP",children:"GBP"}),(0,r.jsx)("option",{value:"CAD",children:"CAD"}),(0,r.jsx)("option",{value:"AUD",children:"AUD"})]})]})]}),h.submit&&(0,r.jsx)("div",{className:"text-red-600 text-sm",children:h.submit}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:a,className:"btn-secondary",disabled:u,children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:"btn-primary",disabled:u,children:u?"Creating...":"Create Project"})]})]})]})}),j&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-60",children:(0,r.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-full max-w-md shadow-lg rounded-md bg-white",children:(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Create New Organization"}),(0,r.jsx)("button",{onClick:()=>_(!1),className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)(i.Z,{className:"h-6 w-6"})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Organization Name *"}),(0,r.jsx)("input",{type:"text",value:v.name,onChange:e=>N(t=>({...t,name:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ".concat(w.name?"border-red-300":"border-gray-300"),placeholder:"Enter organization name"}),w.name&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Email *"}),(0,r.jsx)("input",{type:"email",value:v.contact_email,onChange:e=>N(t=>({...t,contact_email:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ".concat(w.contact_email?"border-red-300":"border-gray-300"),placeholder:"Enter contact email"}),w.contact_email&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.contact_email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Phone"}),(0,r.jsx)("input",{type:"tel",value:v.contact_phone,onChange:e=>N(t=>({...t,contact_phone:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter contact phone"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),(0,r.jsx)("input",{type:"text",value:v.country,onChange:e=>N(t=>({...t,country:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter country"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tax ID"}),(0,r.jsx)("input",{type:"text",value:v.tax_id,onChange:e=>N(t=>({...t,tax_id:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter tax ID"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),(0,r.jsx)("textarea",{value:v.address,onChange:e=>N(t=>({...t,address:e.target.value})),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter organization address"})]}),w.submit&&(0,r.jsx)("div",{className:"text-red-600 text-sm",children:w.submit}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>_(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),(0,r.jsx)("button",{type:"button",onClick:S,className:"px-4 py-2 text-sm font-medium text-white bg-primary-600 border border-transparent rounded-md hover:bg-primary-700",children:"Create Organization"})]})]})]})})})]}):null}},2141:function(e,t,a){a.d(t,{O:function(){return r}});let r=(0,a(8439).eI)("https://gbnmunfdgdnvlzcabyxf.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdibm11bmZkZ2Rudmx6Y2FieXhmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTczOTg5OTIsImV4cCI6MjA3Mjk3NDk5Mn0.dW5qalrprjBpW-A1SjKQ72dU-99JErIawkOuqHnVSBI")},5252:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},9397:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5805:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},2489:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}}]);